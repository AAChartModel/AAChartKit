//
//  JSFunctionForAALegendVC.m
//  AAChartKitDemo
//
//  Created by AnAn on 2022/9/9.
//  Copyright Â© 2022 An An. All rights reserved.
//*************** ............ SOURCE CODE ............ ***************
//***.............................................................  ***
//*** iOS     :https://github.com/AAChartModel/AAChartKit           ***
//*** iOS     :https://github.com/AAChartModel/AAChartKit-Swift     ***
//*** Android :https://github.com/AAChartModel/AAChartCore          ***
//*** Android :https://github.com/AAChartModel/AAChartCore-Kotlin   ***
//***...............................................................***
//*************** ............ SOURCE CODE ............ ***************

/*
 
 * -------------------------------------------------------------------------------
 *
 * ğŸŒ• ğŸŒ– ğŸŒ— ğŸŒ˜  â€â€â€   WARM TIPS!!!   â€â€â€ ğŸŒ‘ ğŸŒ’ ğŸŒ“ ğŸŒ”
 *
 * Please contact me on GitHub,if there are any problems encountered in use.
 * GitHub Issues : https://github.com/AAChartModel/AAChartKit/issues
 * -------------------------------------------------------------------------------
 * And if you want to contribute for this project, please contact me as well
 * GitHub        : https://github.com/AAChartModel
 * StackOverflow : https://stackoverflow.com/users/12302132/codeforu
 * JianShu       : https://www.jianshu.com/u/f1e6753d4254
 * SegmentFault  : https://segmentfault.com/u/huanghunbieguan
 *
 * -------------------------------------------------------------------------------
 
 */

#import "JSFunctionForAALegendVC.h"

@interface JSFunctionForAALegendVC ()

@end

@implementation JSFunctionForAALegendVC

- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

//https://bbs.hcharts.cn/article-109-1.html
//å›¾è¡¨è‡ªå¸¦çš„å›¾ä¾‹ç‚¹å‡»äº‹ä»¶æ˜¯ï¼š
//ç‚¹å‡»æŸä¸ªæ˜¾ç¤º/éšè—çš„å›¾ä¾‹ï¼Œè¯¥å›¾ä¾‹å¯¹åº”çš„serieå°±éšè—/æ˜¾ç¤ºã€‚
//ä¸ªäººè§‰å¾—ä¸åˆç†ï¼Œæ­£å¸¸æ¥è¯´ï¼Œæœ‰å¤šæ¡æŠ˜çº¿(æˆ–å…¶ä»–ç±»å‹çš„å›¾è¡¨)ï¼Œç‚¹å‡»æŸä¸ªå›¾ä¾‹æ˜¯æƒ³åªçœ‹è¯¥å›¾ä¾‹å¯¹åº”çš„æ•°æ®ï¼›
//äºæ˜¯ä¿®æ”¹äº†å›¾ä¾‹ç‚¹å‡»äº‹ä»¶ã€‚
//
//å®ç°çš„æ•ˆæœæ˜¯(ä»¥æŠ˜çº¿å›¾ä¸ºä¾‹)ï¼š
//1. å½“æŸæ¡æŠ˜çº¿éšè—æ—¶ï¼Œç‚¹å‡»è¯¥æŠ˜çº¿çš„å›¾ä¾‹ --> è¯¥æŠ˜çº¿æ˜¾ç¤ºï¼›
//2. å½“å…¨éƒ¨æŠ˜çº¿éƒ½æ˜¾ç¤ºæ—¶ï¼Œç‚¹å‡»æŸä¸ªå›¾ä¾‹ --> è¯¥å›¾ä¾‹å¯¹åº”çš„æŠ˜çº¿æ˜¾ç¤ºï¼Œå…¶ä»–æŠ˜çº¿å‡éšè—ï¼›
//3. å½“åªæœ‰ä¸€æ¡æŠ˜çº¿æ˜¾ç¤ºæ—¶ï¼Œç‚¹å‡»è¯¥æŠ˜çº¿çš„å›¾ä¾‹ --> å…¨éƒ¨æŠ˜çº¿å‡æ˜¾ç¤ºï¼›
//4. å…¶ä»–æƒ…å†µï¼ŒæŒ‰é»˜è®¤å¤„ç†ï¼š
//æ˜¾ç¤º --> éšè—ï¼›
//éšè— --> æ˜¾ç¤ºï¼›
//Customized legengItemClick Event online: http://code.hcharts.cn/rencht/hhhhLv/share
- (AAOptions *)customLegendItemClickEvent {
    AAChartModel *aaChartModel = AAChartModel.new
    .chartTypeSet(AAChartTypeColumn)
    .stackingSet(AAChartStackingTypeNormal)
    .colorsThemeSet(@[@"#fe117c",@"#ffc069",@"#06caf4",@"#7dffc0"])//è®¾ç½®ä¸»é¢˜é¢œè‰²æ•°ç»„
    .markerRadiusSet(@0)
    .seriesSet(@[
        AASeriesElement.new
        .nameSet(@"2017")
        .dataSet(@[@7.0, @6.9, @9.5, @14.5, @18.2, @21.5, @25.2, @26.5, @23.3, @18.3, @13.9, @9.6]),
        AASeriesElement.new
        .nameSet(@"2018")
        .dataSet(@[@0.2, @0.8, @5.7, @11.3, @17.0, @22.0, @24.8, @24.1, @20.1, @14.1, @8.6, @2.5]),
        AASeriesElement.new
        .nameSet(@"2019")
        .dataSet(@[@0.9, @0.6, @3.5, @8.4, @13.5, @17.0, @18.6, @17.9, @14.3, @9.0, @3.9, @1.0]),
        AASeriesElement.new
        .nameSet(@"2020")
        .dataSet(@[@3.9, @4.2, @5.7, @8.5, @11.9, @15.2, @17.0, @16.6, @14.2, @10.3, @6.6, @4.8]),
               ]);
    ;
    
    AAOptions *aaOptions = aaChartModel.aa_toAAOptions;
    
    aaOptions.legend
    .enabledSet(true)
    .alignSet(AAChartAlignTypeRight)//è®¾ç½®å›¾ä¾‹ä½äºæ°´å¹³æ–¹å‘ä¸Šçš„å³ä¾§
    .layoutSet(AAChartLayoutTypeVertical)//è®¾ç½®å›¾ä¾‹æ’åˆ—æ–¹å¼ä¸ºå‚ç›´æ’å¸ƒ
    .verticalAlignSet(AAChartVerticalAlignTypeTop)//è®¾ç½®å›¾ä¾‹ä½äºç«–ç›´æ–¹å‘ä¸Šçš„é¡¶éƒ¨
    ;
        
    //è‡ªå®šä¹‰å›¾ä¾‹ç‚¹å‡»äº‹ä»¶
    aaOptions.plotOptions.series.events = AAEvents.new
    .legendItemClickSet(@AAJSFunc(function(event) {
        function getVisibleMode(series, serieName) {
            var allVisible = true;
            var allHidden = true;
            for (var i = 0; i < series.length; i++) {
                if (series[i].name == serieName)
                    continue;
                allVisible &= series[i].visible;
                allHidden &= (!series[i].visible);
            }
            if (allVisible && !allHidden)
                return 'all-visible';
            if (allHidden && !allVisible)
                return 'all-hidden';
            return 'other-cases';
        }
        
        var series = this.chart.series;
        var mode = getVisibleMode(series, this.name);
        var enableDefault = false;
        if (!this.visible) {
            enableDefault = true;
        }
        else if (mode == 'all-visible') {
            var seriesLength = series.length;
            for (var i = 0; i < seriesLength; i++) {
                var serie = series[i];
                serie.hide();
            }
            this.show();
        }
        else if (mode == 'all-hidden') {
            var seriesLength = series.length;
            for (var i = 0; i < seriesLength; i++) {
                var serie = series[i];
                serie.show();
            }
        }
        else {
            enableDefault = true;
        }
        return enableDefault;
    }));

    return aaOptions;
}


@end
